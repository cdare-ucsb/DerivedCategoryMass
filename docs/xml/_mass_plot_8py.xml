<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="_mass_plot_8py" kind="file" language="Python">
    <compoundname>MassPlot.py</compoundname>
    <innerclass refid="classsrc_1_1_mass_plot_1_1_mass_plot" prot="public">src::MassPlot::MassPlot</innerclass>
    <innernamespace refid="namespacesrc">src</innernamespace>
    <innernamespace refid="namespacesrc_1_1_mass_plot">src::MassPlot</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacesrc_1_1_mass_plot" refkind="compound"><highlight class="keyword">import</highlight><highlight class="normal"><sp/>numpy<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>np</highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>numbers<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Number</highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>plotly.graph_objects<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>go</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>json</highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>plotly</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.SphericalTwist<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>SphericalTwist,<sp/>DoubleSphericalTwist</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.CoherentSheaf<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>LineBundle</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.LocalP2<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>LePotier</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>dotenv<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>load_dotenv</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>os</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Load<sp/>.env<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal">load_dotenv()</highlight></codeline>
<codeline lineno="19"><highlight class="normal">IMPLEMENTED_CATAGORIES<sp/>=<sp/>os.getenv(</highlight><highlight class="stringliteral">&quot;IMPLEMENTED_CATAGORIES&quot;</highlight><highlight class="normal">).split(</highlight><highlight class="stringliteral">&quot;,&quot;</highlight><highlight class="normal">)<sp/></highlight><highlight class="comment">#<sp/>[&apos;P1&apos;,<sp/>&apos;P2&apos;,<sp/>&apos;K3&apos;]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal">__CURRENT_DOUBLE_TWIST_IMPLEMENTED__<sp/>=<sp/>os.getenv(</highlight><highlight class="stringliteral">&quot;CURRENT_DOUBLE_TWIST_IMPLEMENTED&quot;</highlight><highlight class="normal">).split(</highlight><highlight class="stringliteral">&quot;,&quot;</highlight><highlight class="normal">)<sp/></highlight><highlight class="comment">#<sp/>[&apos;K3&apos;]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight></codeline>
<codeline lineno="25" refid="classsrc_1_1_mass_plot_1_1_mass_plot" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classsrc_1_1_mass_plot_1_1_mass_plot" kindref="compound">MassPlot</ref>():</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;!</highlight></codeline>
<codeline lineno="27"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>As<sp/>the<sp/>purpose<sp/>of<sp/>the<sp/>library<sp/>is<sp/>to<sp/>compute<sp/>the<sp/>mass<sp/>of<sp/>spherical<sp/>twists<sp/>in<sp/>certain<sp/>chambers<sp/>of<sp/></highlight></codeline>
<codeline lineno="28"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>stability<sp/>manifolds,<sp/>a<sp/>useful<sp/>functionality<sp/>is<sp/>to<sp/>plot<sp/>a<sp/>certain<sp/>3D<sp/>slice<sp/>of<sp/>the<sp/>graph<sp/>of<sp/></highlight></codeline>
<codeline lineno="29"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>mass<sp/>function.<sp/>Since<sp/>the<sp/>SphericalTwist<sp/>class<sp/>allows<sp/>significant<sp/>flexibiliy<sp/>with<sp/>its<sp/></highlight></codeline>
<codeline lineno="30"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>catagory<sp/>parameter<sp/>(which<sp/>effectively<sp/>dictates<sp/>the<sp/>stability<sp/>manifold<sp/>we<sp/>wish<sp/>to<sp/>graph),<sp/></highlight></codeline>
<codeline lineno="31"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>majority<sp/>of<sp/>the<sp/>plotting<sp/>functionality<sp/>will<sp/>look<sp/>the<sp/>same<sp/>for<sp/>each<sp/>catagory<sp/>(currently</highlight></codeline>
<codeline lineno="32"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&apos;P1&apos;,<sp/>&apos;P2&apos;,<sp/>and<sp/>&apos;K3&apos;).<sp/>The<sp/>only<sp/>difference<sp/>will<sp/>be<sp/>the<sp/>way<sp/>the<sp/>x<sp/>and<sp/>y<sp/>values<sp/>are<sp/>generated</highlight></codeline>
<codeline lineno="33"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>for<sp/>the<sp/>plot.<sp/>Thus,<sp/>this<sp/>class<sp/>acts<sp/>as<sp/>wrapper<sp/>to<sp/>remove<sp/>that<sp/>redundancy<sp/>and<sp/>allow<sp/>for<sp/>easy</highlight></codeline>
<codeline lineno="34"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>plotting<sp/>of<sp/>the<sp/>mass<sp/>function<sp/>for<sp/>a<sp/>given<sp/>spherical<sp/>twist<sp/>in<sp/>a<sp/>given<sp/>chamber<sp/>of<sp/>a<sp/>stability<sp/>manifold.</highlight></codeline>
<codeline lineno="35"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a54bf2dc2d546f8be3cc3ea1ff7e466c9" kindref="member">__init__</ref>(self,<sp/>line_bundle_1,<sp/>line_bundle_2,<sp/>catagory,<sp/></highlight><highlight class="comment">#<sp/>Required<sp/>arguments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line_bundle_3<sp/>=<sp/>None,<sp/>degree=1,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Optional<sp/>for<sp/>double<sp/>twist<sp/>on<sp/>K3s</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x_min=-5,<sp/>x_max=5,<sp/>x_granularity=0.1,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Optional<sp/>for<sp/>x-axis<sp/>range<sp/>and<sp/>granularity</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y_min=0,<sp/>y_max=5,<sp/>y_granularity=0.05):<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Optional<sp/>for<sp/>y-axis<sp/>range<sp/>and<sp/>granularity</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;!</highlight></codeline>
<codeline lineno="43"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Initialize<sp/>the<sp/>MassPlot<sp/>object<sp/>with<sp/>the<sp/>given<sp/>parameters.<sp/>The<sp/>required<sp/>parameters<sp/>are<sp/>the<sp/>line<sp/>bundles</highlight></codeline>
<codeline lineno="44"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>the<sp/>spherical<sp/>twist,<sp/>the<sp/>catagory<sp/>of<sp/>the<sp/>stability<sp/>manifold,<sp/>and<sp/>the<sp/>x<sp/>and<sp/>y<sp/>ranges<sp/>and<sp/>granularities</highlight></codeline>
<codeline lineno="45"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>the<sp/>plot.<sp/>The<sp/>optional<sp/>parameters<sp/>are<sp/>the<sp/>degree<sp/>of<sp/>the<sp/>K3<sp/>surface<sp/>(default<sp/>is<sp/>1),<sp/>and<sp/>a<sp/>third<sp/>line</highlight></codeline>
<codeline lineno="46"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bundle<sp/>for<sp/>the<sp/>double<sp/>spherical<sp/>twist<sp/>(default<sp/>is<sp/>None).</highlight></codeline>
<codeline lineno="47"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="48"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>int<sp/>line_bundle_1<sp/>The<sp/>degree<sp/>of<sp/>the<sp/>outermost<sp/>line<sp/>bundle<sp/>in<sp/>the<sp/>spherical<sp/>twist</highlight></codeline>
<codeline lineno="49"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>int<sp/>line_bundle_2<sp/>The<sp/>degree<sp/>of<sp/>the<sp/>line<sp/>bundle<sp/>being<sp/>twisted<sp/>(if<sp/>line_bundle_3<sp/>is<sp/>None)<sp/>or<sp/>the<sp/>degree<sp/>of<sp/>the<sp/>middle<sp/>line<sp/>bundle<sp/>in<sp/>the<sp/>double<sp/>twist</highlight></codeline>
<codeline lineno="50"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>str<sp/>catagory<sp/>The<sp/>catagory<sp/>of<sp/>the<sp/>stability<sp/>manifold</highlight></codeline>
<codeline lineno="51"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>int<sp/>line_bundle_3<sp/>The<sp/>degree<sp/>of<sp/>the<sp/>line<sp/>bundle<sp/>being<sp/>twisted<sp/>in<sp/>the<sp/>double<sp/>twist<sp/>(default<sp/>is<sp/>None;<sp/>setting<sp/>this<sp/>will<sp/>cause<sp/>the<sp/>object<sp/>to<sp/>compute<sp/>a<sp/>double<sp/>twist)</highlight></codeline>
<codeline lineno="52"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>int<sp/>degree<sp/>The<sp/>degree<sp/>of<sp/>the<sp/>K3<sp/>surface<sp/>(default<sp/>is<sp/>1)</highlight></codeline>
<codeline lineno="53"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>Number<sp/>x_min<sp/>The<sp/>minimum<sp/>x<sp/>value<sp/>for<sp/>the<sp/>plot<sp/>(default<sp/>is<sp/>-5)</highlight></codeline>
<codeline lineno="54"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>Number<sp/>x_max<sp/>The<sp/>maximum<sp/>x<sp/>value<sp/>for<sp/>the<sp/>plot<sp/>(default<sp/>is<sp/>5)</highlight></codeline>
<codeline lineno="55"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>Number<sp/>x_granularity<sp/>The<sp/>distance<sp/>between<sp/>points<sp/>horizontally<sp/>for<sp/>the<sp/>plot<sp/>(default<sp/>is<sp/>0.1)</highlight></codeline>
<codeline lineno="56"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>Number<sp/>y_min<sp/>The<sp/>minimum<sp/>y<sp/>value<sp/>for<sp/>the<sp/>plot<sp/>(default<sp/>is<sp/>0)</highlight></codeline>
<codeline lineno="57"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>Number<sp/>y_max<sp/>The<sp/>maximum<sp/>y<sp/>value<sp/>for<sp/>the<sp/>plot<sp/>(default<sp/>is<sp/>5)</highlight></codeline>
<codeline lineno="58"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>Number<sp/>y_granularity<sp/>The<sp/>distance<sp/>between<sp/>points<sp/>vertically<sp/>for<sp/>the<sp/>plot<sp/>(default<sp/>is<sp/>0.05)</highlight></codeline>
<codeline lineno="59"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(line_bundle_1,<sp/>int)<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(line_bundle_2,<sp/>int):</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Line<sp/>bundles<sp/>must<sp/>be<sp/>integers&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2bc5eab4670559d2c553e78295fd41fe" kindref="member">line_bundle_1</ref><sp/>=<sp/>line_bundle_1<sp/></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a493024a72fb9bb9c2a98861ea8ea6224" kindref="member">line_bundle_2</ref><sp/>=<sp/>line_bundle_2<sp/></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>line_bundle_3<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(line_bundle_3,<sp/>int):</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Line<sp/>bundle<sp/>3<sp/>must<sp/>be<sp/>an<sp/>integer&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>line_bundle_3<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>catagory<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>__CURRENT_DOUBLE_TWIST_IMPLEMENTED__:</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Double<sp/>spherical<sp/>twist<sp/>not<sp/>implemented<sp/>for<sp/>this<sp/>catagory&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>line_bundle_3<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a1020853732496df8e8d8c67d8e166156" kindref="member">_num_twists</ref><sp/>=<sp/>2<sp/></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a1020853732496df8e8d8c67d8e166156" kindref="member">_num_twists</ref><sp/>=<sp/>1</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a3713d45d8db138720243c72a820611a7" kindref="member">line_bundle_3</ref><sp/>=<sp/>line_bundle_3<sp/></highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(degree,<sp/>int):</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Degree<sp/>must<sp/>be<sp/>an<sp/>integer&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>degree<sp/>&lt;<sp/>1:</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Degree<sp/>must<sp/>be<sp/>a<sp/>positive<sp/>integer&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1aafd8e9c0aa1d0835615976dcf557e787" kindref="member">degree</ref><sp/>=<sp/>degree<sp/></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(x_granularity,<sp/>Number)<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(y_granularity,<sp/>Number):</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Granularity<sp/>must<sp/>be<sp/>a<sp/>number&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>y_granularity<sp/>&lt;=<sp/>0<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>x_granularity<sp/>&lt;=<sp/>0:</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Granularity<sp/>must<sp/>be<sp/>a<sp/>positive<sp/>number&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>catagory<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>IMPLEMENTED_CATAGORIES:</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Catagory<sp/>not<sp/>implemented&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref><sp/>=<sp/>catagory<sp/><sp/></highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>y_min<sp/>-<sp/>y_granularity<sp/>&lt;=0:</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>will<sp/>ultimately<sp/>need<sp/>to<sp/>compute<sp/>the<sp/>neighbors<sp/>for<sp/>the<sp/>discrete<sp/>Laplacian</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y_min<sp/>=<sp/>y_granularity</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>y_min<sp/>&gt;=<sp/>y_max:</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;y_min<sp/>must<sp/>be<sp/>less<sp/>than<sp/>y_max&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>x_min<sp/>&gt;=<sp/>x_max:</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;x_min<sp/>must<sp/>be<sp/>less<sp/>than<sp/>x_max&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a16af102415c7f7ca7703f769193693d9" kindref="member">x_min</ref><sp/>=<sp/>x_min<sp/><sp/></highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1afe71021c0e2340d965768a55d96d1689" kindref="member">x_max</ref><sp/>=<sp/>x_max<sp/></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1ae48365d979173558aec788a500909bdc" kindref="member">x_granularity</ref><sp/>=<sp/>x_granularity<sp/><sp/></highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a66e8ca865c2ca66f106cde2ad3127a77" kindref="member">y_min</ref><sp/>=<sp/>y_min<sp/></highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a352ca54ac815e031cb1bf910bf2eabf4" kindref="member">y_max</ref><sp/>=<sp/>y_max<sp/></highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1af39891621318772ff10e26524f19d293" kindref="member">y_granularity</ref><sp/>=<sp/>y_granularity<sp/></highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref><sp/>=<sp/>np.arange(x_min,<sp/>x_max,<sp/>x_granularity)<sp/></highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref><sp/>=<sp/>[]<sp/></highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref><sp/>!=<sp/></highlight><highlight class="stringliteral">&apos;P2&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Catagory<sp/>is<sp/>P1<sp/>or<sp/>K3,<sp/>use<sp/>a<sp/>rectangular<sp/>grid</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>_<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref>:</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref>.append(<sp/><sp/>np.arange(y_min,<sp/>y_max,<sp/>y_granularity)<sp/><sp/>)</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref><sp/>=<sp/>np.array(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref>).flatten()<sp/><sp/></highlight><highlight class="comment">#<sp/>Flatten<sp/>the<sp/>y<sp/>array<sp/>to<sp/>be<sp/>1<sp/>dimensional</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref><sp/>=<sp/>np.repeat(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref>,<sp/>len(np.arange(y_min,<sp/>y_max,<sp/>y_granularity)))<sp/><sp/></highlight><highlight class="comment">#<sp/>Each<sp/>x<sp/>value<sp/>repeats<sp/>y_vals_len<sp/>number<sp/>of<sp/>times<sp/>to<sp/>make<sp/>a<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Catagory<sp/>is<sp/>P2,<sp/>have<sp/>to<sp/>use<sp/>DLP<sp/>curve</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>will<sp/>no<sp/>longer<sp/>use<sp/>y_min<sp/>and<sp/>y_max<sp/>here<sp/>since<sp/>we<sp/>know<sp/>the<sp/>shape<sp/>of<sp/>the<sp/>DLP<sp/>curve</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DLP<sp/>=<sp/><ref refid="classsrc_1_1_local_p2_1_1_le_potier" kindref="compound">LePotier</ref>()</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_abs_x<sp/>=<sp/>max(abs(x_min),<sp/>abs(x_max))</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y_max<sp/>=<sp/>max(DLP.curve_estimate(max_abs_x),<sp/>y_max)<sp/><sp/></highlight><highlight class="comment">#<sp/>y_max<sp/>must<sp/>be<sp/>greater<sp/>than<sp/>the<sp/>Drezet-LePotier<sp/>curve<sp/>over<sp/>the<sp/>x-values<sp/>chosen</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_lin_sp_const<sp/>=<sp/>int(<sp/>(y_max<sp/>+<sp/>0.5)<sp/>/<sp/>y_granularity<sp/>)<sp/><sp/></highlight><highlight class="comment">#<sp/>Linear<sp/>space<sp/>constant</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref>:</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>float(DLP.curve_estimate(x))<sp/></highlight><highlight class="comment">#<sp/>Get<sp/>corresponding<sp/>boundary<sp/>point<sp/>on<sp/>Drezet-LePotier<sp/>Curve</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>y_max<sp/>-<sp/>y<sp/>&lt;<sp/>0:</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;y_max<sp/>must<sp/>be<sp/>greater<sp/>than<sp/>the<sp/>Drezet-LePotier<sp/>curve<sp/>over<sp/>the<sp/>x-values<sp/>chosen&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref>.append(np.linspace(y,<sp/>y_max,<sp/>_lin_sp_const))<sp/><sp/></highlight><highlight class="comment">#<sp/>Linear<sp/>space<sp/>from<sp/>y<sp/>to<sp/>y_max</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Convert<sp/>to<sp/>numpy<sp/>array</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref><sp/>=<sp/>np.array(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref>).flatten()<sp/><sp/></highlight><highlight class="comment">#<sp/>Flatten<sp/>the<sp/>y<sp/>array</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Repeat<sp/>x<sp/>values<sp/>to<sp/>match<sp/>the<sp/>shape<sp/>of<sp/>y</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref><sp/>=<sp/>np.repeat(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref>,<sp/>_lin_sp_const)<sp/><sp/></highlight><highlight class="comment">#<sp/>Each<sp/>x<sp/>value<sp/>repeats<sp/>_lin_sp_const<sp/>times</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a89a74b4b90383de72b9e2d44ddc381fa" kindref="member">get_mass_values</ref>(self):</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;!</highlight></codeline>
<codeline lineno="164"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Compute<sp/>the<sp/>mass<sp/>values<sp/>for<sp/>each<sp/>point<sp/>in<sp/>the<sp/>grid<sp/>formed<sp/>by<sp/>the<sp/>x<sp/>and<sp/>y<sp/>values.</highlight></codeline>
<codeline lineno="165"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>is<sp/>done<sp/>by<sp/>creating<sp/>an<sp/>instance<sp/>of<sp/>the<sp/>SphericalTwist<sp/>class<sp/>and<sp/>then<sp/>calling</highlight></codeline>
<codeline lineno="166"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>mass<sp/>method<sp/>for<sp/>each<sp/>point<sp/>in<sp/>the<sp/>grid.</highlight></codeline>
<codeline lineno="167"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="168"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\return<sp/>np.array<sp/>The<sp/>mass<sp/>values<sp/>for<sp/>each<sp/>point<sp/>in<sp/>the<sp/>grid</highlight></codeline>
<codeline lineno="169"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sph<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a1020853732496df8e8d8c67d8e166156" kindref="member">_num_twists</ref><sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sph<sp/>=<sp/><ref refid="classsrc_1_1_spherical_twist_1_1_spherical_twist" kindref="compound">SphericalTwist</ref>(<ref refid="classsrc_1_1_coherent_sheaf_1_1_line_bundle" kindref="compound">LineBundle</ref>(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2bc5eab4670559d2c553e78295fd41fe" kindref="member">line_bundle_1</ref>,<sp/>catagory=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref>),</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classsrc_1_1_coherent_sheaf_1_1_line_bundle" kindref="compound">LineBundle</ref>(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a493024a72fb9bb9c2a98861ea8ea6224" kindref="member">line_bundle_2</ref>,<sp/>catagory=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref>),</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>degree=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1aafd8e9c0aa1d0835615976dcf557e787" kindref="member">degree</ref>)</highlight></codeline>
<codeline lineno="177"><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a1020853732496df8e8d8c67d8e166156" kindref="member">_num_twists</ref><sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sph<sp/>=<sp/><ref refid="classsrc_1_1_spherical_twist_1_1_double_spherical_twist" kindref="compound">DoubleSphericalTwist</ref>(<ref refid="classsrc_1_1_coherent_sheaf_1_1_line_bundle" kindref="compound">LineBundle</ref>(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2bc5eab4670559d2c553e78295fd41fe" kindref="member">line_bundle_1</ref>,<sp/>catagory=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref>),</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classsrc_1_1_coherent_sheaf_1_1_line_bundle" kindref="compound">LineBundle</ref>(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a493024a72fb9bb9c2a98861ea8ea6224" kindref="member">line_bundle_2</ref>,<sp/>catagory=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref>),</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classsrc_1_1_coherent_sheaf_1_1_line_bundle" kindref="compound">LineBundle</ref>(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a3713d45d8db138720243c72a820611a7" kindref="member">line_bundle_3</ref>,<sp/>catagory=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref>),</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>degree=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1aafd8e9c0aa1d0835615976dcf557e787" kindref="member">degree</ref>)</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Invalid<sp/>number<sp/>of<sp/>twists&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&apos;P2&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.array([sph.mass(x,<sp/>y)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x,<sp/>y<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref>,<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref>)])</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&apos;P1&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.array([sph.mass(complex(x,<sp/>y))<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x,<sp/>y<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref>,<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref>)])</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&apos;K3&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.array([sph.mass(x,<sp/>y,<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1aafd8e9c0aa1d0835615976dcf557e787" kindref="member">degree</ref>)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x,<sp/>y<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref>,<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref>)])</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Invalid<sp/>catagory&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1ab41d45af85b48d7e8b70e8e983869211" kindref="member">to_plotly_figure</ref>(self,<sp/>color_scale=&apos;viridis&apos;,<sp/>marker_size=3):</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;!</highlight></codeline>
<codeline lineno="198"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>primariy<sp/>functionality<sp/>of<sp/>this<sp/>class;<sp/>generate<sp/>a<sp/>plotly<sp/>figure<sp/>of<sp/>the<sp/>mass<sp/>function</highlight></codeline>
<codeline lineno="199"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>the<sp/>given<sp/>spherical<sp/>twist<sp/>in<sp/>the<sp/>given<sp/>chamber<sp/>of<sp/>the<sp/>stability<sp/>manifold.<sp/>The<sp/>mass<sp/>values</highlight></codeline>
<codeline lineno="200"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>are<sp/>computed<sp/>for<sp/>each<sp/>point<sp/>in<sp/>the<sp/>grid<sp/>formed<sp/>by<sp/>the<sp/>x<sp/>and<sp/>y<sp/>values,<sp/>and<sp/>then<sp/>plotted<sp/>as<sp/>a<sp/>3D</highlight></codeline>
<codeline lineno="201"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scatter<sp/>plot.</highlight></codeline>
<codeline lineno="202"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="203"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>str<sp/>color_scale<sp/>The<sp/>color<sp/>scale<sp/>to<sp/>use<sp/>for<sp/>the<sp/>plot</highlight></codeline>
<codeline lineno="204"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>int<sp/>marker_size<sp/>The<sp/>size<sp/>of<sp/>the<sp/>markers<sp/>in<sp/>the<sp/>plot</highlight></codeline>
<codeline lineno="205"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="206"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\return<sp/>go.Figure<sp/>The<sp/>plotly<sp/>figure<sp/>of<sp/>the<sp/>mass<sp/>function</highlight></codeline>
<codeline lineno="207"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>masses<sp/>=<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a89a74b4b90383de72b9e2d44ddc381fa" kindref="member">get_mass_values</ref>()</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Plot<sp/>the<sp/>surface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fig<sp/>=<sp/>go.Figure(data=[go.Scatter3d(z=masses,<sp/>x=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref>,<sp/>y=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref>,</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mode=</highlight><highlight class="stringliteral">&apos;markers&apos;</highlight><highlight class="normal">,<sp/>marker=dict(size=marker_size,<sp/>color=masses,<sp/>colorscale=color_scale))])</highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fig.update_layout(</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title=</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>autosize=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>margin=dict(l=0,<sp/>r=0,<sp/>b=0,<sp/>t=30),</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scene=dict(</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bgcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>Changes<sp/>the<sp/>3D<sp/>plot<sp/>background<sp/>,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xaxis<sp/>=<sp/>dict(</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>backgroundcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gridcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>showbackground<sp/>=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zerolinecolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,),</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yaxis<sp/>=<sp/>dict(</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>backgroundcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gridcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>showbackground<sp/>=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zerolinecolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zaxis<sp/>=<sp/>dict(</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>backgroundcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gridcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>showbackground<sp/>=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zerolinecolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>fig</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a9dd42ce63527140fbe41eed6009a5544" kindref="member">to_plotly_json</ref>(self,<sp/>color_scale=&apos;viridis&apos;,<sp/>marker_size=3):</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;!</highlight></codeline>
<codeline lineno="248"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Function<sp/>to<sp/>convert<sp/>the<sp/>plotly<sp/>figure<sp/>to<sp/>a<sp/>JSON<sp/>string.<sp/>This<sp/>is<sp/>useful<sp/>for<sp/>rendering<sp/>the<sp/>plot</highlight></codeline>
<codeline lineno="249"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>in<sp/>a<sp/>web<sp/>application.</highlight></codeline>
<codeline lineno="250"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="251"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>str<sp/>color_scale<sp/>The<sp/>color<sp/>scale<sp/>to<sp/>use<sp/>for<sp/>the<sp/>plot</highlight></codeline>
<codeline lineno="252"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\param<sp/>int<sp/>marker_size<sp/>The<sp/>size<sp/>of<sp/>the<sp/>markers<sp/>in<sp/>the<sp/>plot</highlight></codeline>
<codeline lineno="253"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="254"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\return<sp/>str<sp/>The<sp/>JSON<sp/>string<sp/>of<sp/>the<sp/>plotly<sp/>figure</highlight></codeline>
<codeline lineno="255"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fig<sp/>=<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1ab41d45af85b48d7e8b70e8e983869211" kindref="member">to_plotly_figure</ref>(color_scale=color_scale,<sp/>marker_size=marker_size)</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>json.dumps(fig,<sp/>cls=plotly.utils.PlotlyJSONEncoder)</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1ae4280772d8d39404953f177ce6161bb1" kindref="member">get_discretized_Laplacian_values</ref>(self):</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sph<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a1020853732496df8e8d8c67d8e166156" kindref="member">_num_twists</ref><sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sph<sp/>=<sp/><ref refid="classsrc_1_1_spherical_twist_1_1_spherical_twist" kindref="compound">SphericalTwist</ref>(<ref refid="classsrc_1_1_coherent_sheaf_1_1_line_bundle" kindref="compound">LineBundle</ref>(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2bc5eab4670559d2c553e78295fd41fe" kindref="member">line_bundle_1</ref>,<sp/>catagory=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref>),</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classsrc_1_1_coherent_sheaf_1_1_line_bundle" kindref="compound">LineBundle</ref>(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a493024a72fb9bb9c2a98861ea8ea6224" kindref="member">line_bundle_2</ref>,<sp/>catagory=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref>),</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>degree=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1aafd8e9c0aa1d0835615976dcf557e787" kindref="member">degree</ref>)</highlight></codeline>
<codeline lineno="272"><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a1020853732496df8e8d8c67d8e166156" kindref="member">_num_twists</ref><sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sph<sp/>=<sp/><ref refid="classsrc_1_1_spherical_twist_1_1_double_spherical_twist" kindref="compound">DoubleSphericalTwist</ref>(<ref refid="classsrc_1_1_coherent_sheaf_1_1_line_bundle" kindref="compound">LineBundle</ref>(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2bc5eab4670559d2c553e78295fd41fe" kindref="member">line_bundle_1</ref>,<sp/>catagory=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref>),</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classsrc_1_1_coherent_sheaf_1_1_line_bundle" kindref="compound">LineBundle</ref>(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a493024a72fb9bb9c2a98861ea8ea6224" kindref="member">line_bundle_2</ref>,<sp/>catagory=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref>),</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classsrc_1_1_coherent_sheaf_1_1_line_bundle" kindref="compound">LineBundle</ref>(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a3713d45d8db138720243c72a820611a7" kindref="member">line_bundle_3</ref>,<sp/>catagory=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref>),</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>degree=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1aafd8e9c0aa1d0835615976dcf557e787" kindref="member">degree</ref>)</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Invalid<sp/>number<sp/>of<sp/>twists&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">_disc_Lapl(x,<sp/>y):</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&apos;P2&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>sph.mass(x<sp/>+<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1ae48365d979173558aec788a500909bdc" kindref="member">x_granularity</ref>,<sp/>y)<sp/>+<sp/>sph.mass(x<sp/>-<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1ae48365d979173558aec788a500909bdc" kindref="member">x_granularity</ref>,<sp/>y)<sp/>+<sp/>sph.mass(x,<sp/>y<sp/>+<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1af39891621318772ff10e26524f19d293" kindref="member">y_granularity</ref>)<sp/>+<sp/>sph.mass(x,<sp/>y<sp/>-<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1af39891621318772ff10e26524f19d293" kindref="member">y_granularity</ref>)<sp/>-<sp/>4*sph.mass(x,<sp/>y)</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&apos;P1&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>sph.mass(complex(x<sp/>+<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1ae48365d979173558aec788a500909bdc" kindref="member">x_granularity</ref>,<sp/>y))<sp/>+<sp/>sph.mass(complex(x<sp/>-<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1ae48365d979173558aec788a500909bdc" kindref="member">x_granularity</ref>,<sp/>y))<sp/>+<sp/>sph.mass(complex(x,<sp/>y<sp/>+<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1af39891621318772ff10e26524f19d293" kindref="member">y_granularity</ref>))<sp/>+<sp/>sph.mass(complex(x,<sp/>y<sp/>-<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1af39891621318772ff10e26524f19d293" kindref="member">y_granularity</ref>))<sp/>-<sp/>4*sph.mass(complex(x,<sp/>y))</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a2dd27d5e9bbbc4d48244766303efe86f" kindref="member">catagory</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&apos;K3&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>sph.mass(x<sp/>+<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1ae48365d979173558aec788a500909bdc" kindref="member">x_granularity</ref>,<sp/>y,<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1aafd8e9c0aa1d0835615976dcf557e787" kindref="member">degree</ref>)<sp/>+<sp/>sph.mass(x<sp/>-<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1ae48365d979173558aec788a500909bdc" kindref="member">x_granularity</ref>,<sp/>y,<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1aafd8e9c0aa1d0835615976dcf557e787" kindref="member">degree</ref>)<sp/>+<sp/>sph.mass(x,<sp/>y<sp/>+<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1af39891621318772ff10e26524f19d293" kindref="member">y_granularity</ref>,<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1aafd8e9c0aa1d0835615976dcf557e787" kindref="member">degree</ref>)<sp/>+<sp/>sph.mass(x,<sp/>y<sp/>-<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1af39891621318772ff10e26524f19d293" kindref="member">y_granularity</ref>,<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1aafd8e9c0aa1d0835615976dcf557e787" kindref="member">degree</ref>)<sp/>-<sp/>4*sph.mass(x,<sp/>y,<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1aafd8e9c0aa1d0835615976dcf557e787" kindref="member">degree</ref>)</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&quot;Invalid<sp/>catagory&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.array([_disc_Lapl(x,<sp/>y)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x,<sp/>y<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref>,<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref>)])</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a210348d37db75853f20f51b54ebfb97a" kindref="member">discretized_Laplacian_to_plotly_figure</ref>(self,<sp/>color_scale=&apos;Plasma&apos;,<sp/>marker_size=3):</highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disc_vals<sp/>=<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1ae4280772d8d39404953f177ce6161bb1" kindref="member">get_discretized_Laplacian_values</ref>()</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disc_vals_mean<sp/>=<sp/>np.mean(disc_vals)</highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>colors<sp/>=<sp/>np.abs(disc_vals<sp/>-<sp/>disc_vals_mean)<sp/><sp/></highlight><highlight class="comment">#<sp/>Highlight<sp/>stronger<sp/>discontinuities</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fig<sp/>=<sp/>go.Figure(data=[go.Scatter3d(z=disc_vals,<sp/>x=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref>,<sp/>y=self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref>,</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mode=</highlight><highlight class="stringliteral">&apos;markers&apos;</highlight><highlight class="normal">,<sp/>marker=dict(size=marker_size,<sp/>color=colors,<sp/>colorscale=color_scale))])</highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fig.update_layout(</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title=</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>autosize=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>margin=dict(l=0,<sp/>r=0,<sp/>b=0,<sp/>t=30),</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scene=dict(</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bgcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>Changes<sp/>the<sp/>3D<sp/>plot<sp/>background<sp/>,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xaxis<sp/>=<sp/>dict(</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>backgroundcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gridcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>showbackground<sp/>=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zerolinecolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,),</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yaxis<sp/>=<sp/>dict(</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>backgroundcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gridcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>showbackground<sp/>=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zerolinecolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zaxis<sp/>=<sp/>dict(</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>backgroundcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gridcolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>showbackground<sp/>=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zerolinecolor=</highlight><highlight class="stringliteral">&quot;white&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="331"><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>fig</highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a51be2ce6195a8a25edb2785d0552dbcf" kindref="member">find_discontinuities</ref>(self,<sp/>std_dev_threshold=1):</highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disc_vals<sp/>=<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1ae4280772d8d39404953f177ce6161bb1" kindref="member">get_discretized_Laplacian_values</ref>()</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disc_vals_mean<sp/>=<sp/>np.mean(disc_vals)</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disc_vals_std<sp/>=<sp/>np.std(disc_vals)</highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>discontinuities<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x,<sp/>y,<sp/>disc_val<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a0c6501bd5875afd2b5bd085813f42e5e" kindref="member">_xvals</ref>,<sp/>self.<ref refid="classsrc_1_1_mass_plot_1_1_mass_plot_1a25ea848ba3d4751bfc89fa1761fd1da4" kindref="member">_yvals</ref>,<sp/>disc_vals):</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Our<sp/>threshold<sp/>will<sp/>be<sp/>1<sp/>standard<sp/>deviation<sp/>above<sp/>the<sp/>mean</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>abs(disc_val<sp/>-<sp/>disc_vals_mean)<sp/>&gt;<sp/>std_dev_threshold*disc_vals_std:</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>discontinuities.append((x,<sp/>y))</highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>discontinuities</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>__name__<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;__main__&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/>mp<sp/>=<sp/><ref refid="classsrc_1_1_mass_plot_1_1_mass_plot" kindref="compound">MassPlot</ref>(line_bundle_1=1,<sp/>line_bundle_2=5,</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x_min=-10,<sp/>x_max=10,</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y_min=0,<sp/>y_max<sp/>=<sp/>20,</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>catagory=</highlight><highlight class="stringliteral">&apos;K3&apos;</highlight><highlight class="normal">,<sp/>degree=1)</highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/>fig1<sp/>=<sp/>mp.to_plotly_figure()</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/>fig1.show()</highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/>fig2<sp/>=<sp/>mp.discretized_Laplacian_to_plotly_figure()</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/>fig2.show()</highlight></codeline>
<codeline lineno="377"><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="src/MassPlot.py"/>
  </compounddef>
</doxygen>
